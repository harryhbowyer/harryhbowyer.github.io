(window.webpackJsonpproject1=window.webpackJsonpproject1||[]).push([[0],{201:function(e,t){},226:function(e,t,n){e.exports=n(440)},231:function(e,t,n){},362:function(e,t,n){},363:function(e,t,n){},39:function(e){e.exports=JSON.parse('{"token1":"xOQ.ZpTnU2QsPxaVoXtkLQUrLEJAjeI","token2":"NjM4OTAzMjIzODQ2OTYxMTYz.Xby","url":"https://discordapp.com/api/v7"}')},405:function(e,t,n){},406:function(e,t,n){},408:function(e,t,n){},413:function(e,t){},414:function(e,t){},415:function(e,t,n){},432:function(e,t,n){},433:function(e,t,n){},434:function(e,t,n){},436:function(e,t,n){},437:function(e,t,n){},438:function(e,t,n){},440:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(9),i=n.n(o),s=n(162),c=n(70),l=n(18),d=n(19),u=n(22),f=n(20),m=n(21),p=n(60),h=(n(231),n(221)),y=n(41),v=n(7),g=n(448);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e,t=this,n=this.state.sortedInfo||{},a=function(e,n){n(),t.setState({searchText:e[0]})},o=[b({title:"Recipe Name",dataIndex:"name"},(e="name",{filterDropdown:function(n){var o=n.setSelectedKeys,i=n.selectedKeys,s=n.confirm,c=n.clearFilters;return r.a.createElement("div",{style:{padding:8}},r.a.createElement(h.a,{ref:function(e){t.searchInput=e},placeholder:"Search ".concat(e),value:i[0],onChange:function(e){return o(e.target.value?[e.target.value]:[])},onPressEnter:function(){return a(i,s)},style:{width:188,marginBottom:8,display:"block"}}),r.a.createElement(y.a,{type:"primary",onClick:function(){return a(i,s)},icon:"search",size:"small",style:{width:90,marginRight:8}},"Search"),r.a.createElement(y.a,{onClick:function(){return function(e){e(),t.setState({searchText:""})}(c)},size:"small",style:{width:90}},"Reset"))},filterIcon:function(e){return r.a.createElement(v.a,{type:"search",style:{color:e?"#1890ff":void 0}})},onFilter:function(t,n){return n[e].toString().toLowerCase().includes(t.toLowerCase())},onFilterDropdownVisibleChange:function(e){e&&setTimeout((function(){return t.searchInput.select()}))}})),{title:"Type",dataIndex:"type"},{title:"Ingredients",dataIndex:"icount",sorter:function(e,t){return e.icount<t.icount?-1:e.icount===t.icount?0:1},sortOrder:"icount"===n.columnKey&&n.order}];return r.a.createElement(g.a,{columns:o,dataSource:window.foodnet.recipes.sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1})).map((function(e){return b({},e,{type:"Custom",icount:(e.ingredients||[]).length})})),pagination:!1,rowKey:"id",rowClassName:function(e){return"recipe-list-item"+(window.foodnet.selected===e.id?" selected":"")},onRow:function(e){return{onClick:function(){window.foodnet.selected=e.id,t.props.select(e.id),t.setState({selectedRowKeys:[e.id]})}}},onChange:function(e,n,a){t.setState({sortedInfo:a})}})}}]),t}(r.a.Component),k=n(441),O=(n(362),n(10)),S=n.n(O),C=function(e){return!!window.foodnet.events.find((function(t){return t.recipe===e}))},j=function(e){return!window.foodnet.events.filter((function(e){return S()(e.date).isAfter(S()().startOf("day"))})).find((function(t){return t.recipe===e}))},I=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props.selected&&C(this.props.selected)&&j(this.props.selected);return r.a.createElement("div",{className:"recipe-toolbar"},r.a.createElement(y.a,{onClick:function(){return e.props.showModal("add")}},"Add"),r.a.createElement(y.a,{disabled:!this.props.selected,onClick:function(){return e.props.showModal("edit")}},"Edit"),r.a.createElement(k.a,{title:"This is still used in old calendar events. Are you sure?",onConfirm:function(){return e.props.delete()},okText:"Yes",cancelText:"No",disabled:!this.props.selected||!t,placement:"bottom"},r.a.createElement(y.a,{disabled:!this.props.selected,onClick:function(){t||e.props.delete()}},"Delete")))}}]),t}(r.a.Component),N=n(442),x=n(453),T=n(40),D=n(451),M=n(131),q=n(170),P=n(51),L=(n(363),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=function(){var t=window.foodnet.ingredients.map((function(e){return e.name}));return e.props.edit&&(t=window.foodnet.ingredients.filter((function(t){return t.id!==e.state.id})).map((function(e){return e.name}))),-1===t.indexOf(e.state.name)},n=function(){e.props.edit?(window.foodnet.ingredients.find((function(t){return t.id===e.state.id})).name=e.state.name.trim(),e.props.close()):(window.foodnet.ingredients.push({id:0===window.foodnet.ingredients.length?1:Math.max.apply(Math,Object(T.a)(window.foodnet.ingredients.map((function(e){return e.id}))))+1,name:e.state.name.trim()}),window.foodnet.sync(),e.props.close())};return r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:12}}},this.props.edit&&this.renderPicker(),r.a.createElement(D.a.Item,{label:this.props.edit?"New Name":"Name",validateStatus:this.state.name&&t()?"success":"error",hasFeedback:!0,help:this.state.name&&t()?void 0:this.state.name?"Name should be unique":"Should not be blank"},r.a.createElement(h.a,{autoFocus:!0,value:this.state.name,placeholder:"Enter a name",onChange:function(t){return e.setState({name:t.target.value})},onPressEnter:function(){e.validate()||n()}}))),r.a.createElement("div",{className:"footer"},this.props.edit&&r.a.createElement(y.a,{key:"delete",type:"danger",disabled:!this.state.id,onClick:function(){var t;t=e.state.id,window.foodnet.recipes.find((function(e){return e.ingredients.find((function(e){return e.id===t}))}))?N.a.error("This ingredient is still being used. Please remove, replace, or rename the ingredient where it is being used before deleting."):(window.foodnet.ingredients=window.foodnet.ingredients.filter((function(t){return t.id!==e.state.id})),window.foodnet.sync(),e.props.close())}},"Delete"),r.a.createElement(y.a,{key:"back",onClick:function(){return e.props.close()}},"Cancel"),r.a.createElement(y.a,{type:"primary",disabled:this.validate(),onClick:function(){return n()}},"Submit")))}},{key:"renderPicker",value:function(){var e=this;return r.a.createElement(D.a.Item,{label:"Choose existing ingredient",validateStatus:this.props.edit&&!this.state.id?"error":"success",hasFeedback:!0},r.a.createElement(P.a,{value:this.state.id?this.state.id.toString():void 0,onChange:function(t){e.setState({id:Number(t),name:window.foodnet.ingredients.find((function(e){return e.id===Number(t)})).name})}},window.foodnet.ingredients.map((function(e){return r.a.createElement(P.a.Option,{key:e.id},e.name)}))))}},{key:"validate",value:function(){return!this.state.name||this.props.edit&&!this.state.id}}]),t}(r.a.Component)),A=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=function(){var t=window.foodnet.measurements.map((function(e){return e.name}));return e.props.edit&&(t=window.foodnet.measurements.filter((function(t){return t.id!==e.state.id})).map((function(e){return e.name}))),-1===t.indexOf(e.state.name)},n=function(){e.props.edit?window.foodnet.measurements.find((function(t){return t.id===e.state.id})).name=e.state.name.trim():window.foodnet.measurements.push({id:0===window.foodnet.measurements.length?1:Math.max.apply(Math,Object(T.a)(window.foodnet.measurements.map((function(e){return e.id}))))+1,name:e.state.name.trim()});e.props.close(),window.foodnet.sync()};return r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:12}}},this.props.edit&&this.renderPicker(),r.a.createElement(D.a.Item,{label:this.props.edit?"New Name":"Name",validateStatus:this.state.name&&t()?"success":"error",hasFeedback:!0,help:this.state.name&&t()?void 0:this.state.name?"Name should be unique":"Should not be blank"},r.a.createElement(h.a,{autoFocus:!0,value:this.state.name,placeholder:"Enter a name",onChange:function(t){return e.setState({name:t.target.value})},onPressEnter:function(){e.validate()||n()}}))),r.a.createElement("div",{className:"footer"},this.props.edit&&r.a.createElement(y.a,{key:"delete",type:"danger",disabled:!this.state.id,onClick:function(){var t;t=e.state.id,window.foodnet.recipes.find((function(e){return e.ingredients.find((function(e){return e.type===t}))}))?N.a.error("This measurement is still being used. Please remove, replace, or rename the measurement where it is being used before deleting."):(window.foodnet.measurements=window.foodnet.measurements.filter((function(t){return t.id!==e.state.id})),window.foodnet.sync(),e.props.close())}},"Delete"),r.a.createElement(y.a,{key:"back",onClick:function(){return e.props.close()}},"Cancel"),r.a.createElement(y.a,{type:"primary",disabled:this.validate(),onClick:function(){return n()}},"Submit")))}},{key:"renderPicker",value:function(){var e=this;return r.a.createElement(D.a.Item,{label:"Choose existing measurement",validateStatus:this.props.edit&&!this.state.id?"error":"success",hasFeedback:!0},r.a.createElement(P.a,{value:this.state.id?this.state.id.toString():void 0,onChange:function(t){e.setState({id:Number(t),name:window.foodnet.measurements.find((function(e){return e.id===Number(t)})).name})}},window.foodnet.measurements.map((function(e){return r.a.createElement(P.a.Option,{key:e.id},e.name)}))))}},{key:"validate",value:function(){return!this.state.name||this.props.edit&&!this.state.id}}]),t}(r.a.Component);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={ingredients:[]},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.props.edit&&!this.state.name){var t=window.foodnet.recipes.find((function(t){return t.id===e.props.edit}));this.setState(F({},t))}}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,Object.assign({},{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:12}}},{className:"recipe-form"}),r.a.createElement(D.a.Item,{label:"Name",validateStatus:this.state.name?"success":"error",hasFeedback:!0,help:this.state.name?void 0:"Should not be blank"},r.a.createElement(h.a,{placeholder:"Enter a name",value:this.state.name,onChange:function(t){return e.setState({name:t.target.value})}})),this.renderConfigMenu(),this.renderMultichooser(),this.renderTable(),r.a.createElement(D.a.Item,{className:"instructions",label:"Instructions"},r.a.createElement(h.a.TextArea,{value:this.state.desc,autoSize:{minRows:2,maxRows:6},onChange:function(t){return e.setState({desc:t.target.value})}}))),r.a.createElement("div",{className:"footer"},r.a.createElement(y.a,{key:"back",onClick:function(){return e.props.close()}},"Cancel"),r.a.createElement(y.a,{type:"primary",disabled:this.validateForm(),onClick:function(){if(e.state.id)window.foodnet.recipes=window.foodnet.recipes.filter((function(t){return t.id!==e.state.id})).concat(F({},e.state,{name:e.state.name.trim()}));else{var t=0===window.foodnet.recipes.length?1:Math.max.apply(Math,Object(T.a)(window.foodnet.recipes.map((function(e){return e.id}))))+1;window.foodnet.recipes.push(F({},e.state,{name:e.state.name.trim(),id:t}))}window.foodnet.sync(),e.props.close()}},"Submit")),this.renderModal(),this.renderTModal())}},{key:"renderConfigMenu",value:function(){var e=this;return r.a.createElement("div",{className:"config"},"Configure Ingredients/Measurements",r.a.createElement(M.a,{trigger:["click"],overlay:r.a.createElement(q.a,{onClick:function(t){switch(t.key){case"1":e.setState({modal:"add"});break;case"2":e.setState({modal:"edit"});break;case"3":e.setState({tmodal:"add"});break;case"4":e.setState({tmodal:"edit"})}}},r.a.createElement(q.a.Item,{key:"1"},r.a.createElement(v.a,{type:"plus"}),"Create New Ingredient"),r.a.createElement(q.a.Item,{key:"2"},r.a.createElement(v.a,{type:"edit"})," Edit Existing Ingredients"),r.a.createElement(q.a.Divider,null),r.a.createElement(q.a.Item,{key:"3"},r.a.createElement(v.a,{type:"plus"})," Create New Measurement"),r.a.createElement(q.a.Item,{key:"4"},r.a.createElement(v.a,{type:"edit"})," Edit Existing Measurements"))},r.a.createElement(v.a,{type:"setting",className:"setting-icon"})))}},{key:"renderModal",value:function(){var e=this;return this.state.modal&&r.a.createElement(x.a,{width:"90%",visible:!0,footer:null,onCancel:function(){return e.setState({modal:void 0})}},r.a.createElement(L,{edit:"edit"===this.state.modal||void 0,close:function(){return e.setState({modal:void 0})}}))}},{key:"renderTModal",value:function(){var e=this;return this.state.tmodal&&r.a.createElement(x.a,{width:"90%",visible:!0,footer:null,onCancel:function(){return e.setState({tmodal:void 0})}},r.a.createElement(A,{edit:"edit"===this.state.tmodal||void 0,close:function(){return e.setState({tmodal:void 0})}}))}},{key:"renderTable",value:function(){var e=this,t=function(e,t,n){return r.a.createElement(D.a.Item,{validateStatus:t?"success":"error",help:t?"":n},e)},n=[{title:"Name",dataIndex:"id",key:"name",render:function(e){var t=window.foodnet.ingredients.find((function(t){return t.id===e}));return r.a.createElement("div",null,t.name)}},{title:"Amount",dataIndex:"id",key:"qty",render:function(n){var a=e.state.ingredients.find((function(e){return e.id===n}));return t(r.a.createElement(h.a,{type:"number",value:a.qty,onChange:function(t){e.setState({ingredients:e.state.ingredients.filter((function(e){return e.id!==n})).concat([F({},e.state.ingredients.find((function(e){return e.id===n})),{qty:t.target.value})])})}}),a.qty,"Should not be blank")}},{title:"Type",dataIndex:"id",key:"type",render:function(n){var a=e.state.ingredients.find((function(e){return e.id===n}));return t(r.a.createElement(P.a,{placeholder:"Type",filterOption:function(e,t){var n=t.props.children,a="string"===typeof e||e instanceof String?e:e.toString();return(n||"").toLowerCase().indexOf((a||"").toLowerCase())},value:a.type?a.type.toString():void 0,onChange:function(t){e.setState({ingredients:e.state.ingredients.filter((function(e){return e.id!==a.id})).concat(e.state.ingredients.filter((function(e){return e.id===a.id})).map((function(e){return F({},e,{type:Number(t)})})))})}},window.foodnet.measurements.sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1})).map((function(e){return r.a.createElement(P.a.Option,{key:e.id},e.name)}))),a.type,"Should not be blank")}}],a=this.state.ingredients.sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1}));return this.state.ingredients.length>0&&r.a.createElement(g.a,{columns:n,dataSource:a,pagination:!1,rowKey:"id"})}},{key:"renderMultichooser",value:function(){var e=this;return r.a.createElement(P.a,{className:"multi-chooser",mode:"multiple",placeholder:0===window.foodnet.ingredients.length?"Use the gear menu to create new ingredients":"Please select",value:this.state.ingredients.sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1})).map((function(e){return{key:e.id}})),disabled:0===window.foodnet.ingredients.length,onChange:function(t){var n=t.map((function(e){return Number(e.key)})),a=e.state.ingredients.map((function(e){return e.id})).filter((function(e){return-1!==n.indexOf(e)})),r=n.filter((function(t){return-1===e.state.ingredients.map((function(e){return e.id})).indexOf(t)}));e.setState({ingredients:e.state.ingredients.filter((function(e){return-1!==a.indexOf(e.id)})).concat(r.map((function(e){return F({},window.foodnet.ingredients.find((function(t){return t.id===e})))}))).sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1}))})},labelInValue:!0},window.foodnet.ingredients.sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1})).map((function(e){return r.a.createElement(P.a.Option,{key:e.id,value:e.id},e.name)})))}},{key:"renderIngAddButton",value:function(){var e=this;return r.a.createElement(y.a,{onClick:function(){e.setState({modal:"add"})}},"Create New Ingredient")}},{key:"renderIngEditButton",value:function(){var e=this;return r.a.createElement(y.a,{onClick:function(){e.setState({modal:"edit"})}},"Edit Existing Ingredients")}},{key:"renderTypeAddButton",value:function(){var e=this;return r.a.createElement(y.a,{onClick:function(){e.setState({tmodal:"add"})}},"Create New Measurement")}},{key:"renderTypeEditButton",value:function(){var e=this;return r.a.createElement(y.a,{onClick:function(){e.setState({tmodal:"edit"})}},"Edit Existing Measurements")}},{key:"validateForm",value:function(){if(!(this.state.name&&this.state.name.trim().length>0&&this.state.ingredients&&this.state.ingredients.length>0))return!0;for(var e in this.state.ingredients||[]){var t=this.state.ingredients[e];if(!t.type||!t.qty)return!0}return!1}}]),t}(r.a.Component),U=(n(405),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={modal:!1},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.renderToolbar(),this.renderList(),this.renderModal())}},{key:"renderList",value:function(){var e=this;return r.a.createElement(E,{selected:window.foodnet.selected,select:function(t){return e.forceUpdate()}})}},{key:"renderToolbar",value:function(){var e=this;return r.a.createElement(I,{selected:window.foodnet.selected,showModal:function(t){return e.setState({modal:t})},delete:function(){return e.handleDelete()}})}},{key:"handleDelete",value:function(){C(window.foodnet.selected)&&!j(window.foodnet.selected)?N.a.error("This recipe is still being used. Please remove or replace the recipe where it is being used before deleting."):(window.foodnet.recipes=window.foodnet.recipes.filter((function(e){return e.id!==window.foodnet.selected})),window.foodnet.events=window.foodnet.events.filter((function(e){return e.recipe!==window.foodnet.selected})),window.foodnet.selected=void 0,window.foodnet.sync(),this.forceUpdate())}},{key:"renderModal",value:function(){var e=this;return this.state.modal&&r.a.createElement(x.a,{width:"90%",visible:!0,footer:null,onCancel:function(){return e.setState({modal:void 0})},maskClosable:!1,keyboard:!0},r.a.createElement(_,{edit:"edit"===this.state.modal?window.foodnet.selected:void 0,close:function(){return e.setState({modal:void 0})}}))}}]),t}(r.a.Component)),B=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(_,null)}}]),t}(r.a.Component),V=(n(406),Object(c.e)((function(e){return r.a.createElement(z,e)}))),J=r.a.createElement(v.a,{type:"heart",theme:"twoTone",twoToneColor:"#eb2f96"}),K=r.a.createElement(v.a,{type:"calendar",theme:"twoTone"}),z=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return r.a.createElement(q.a,{onClick:function(t){return function(t){switch(t){case"recipes":e.props.history.push("");break;case"planner":e.props.history.push("Planner");break;case"shopper":e.props.history.push("Shopper");break;case"inventory":e.props.history.push("Inventory");break;case"importexport":e.props.history.push("ImportExport");break;case"online":e.props.history.push("Online");break;case"reports":e.props.history.push("Reports");break;case"about":e.props.history.push("About")}}(t.key)},selectedKeys:[function(){var t=e.props.location.pathname.substring(1);switch(t){case"ImportExport":case"Reports":case"Planner":case"Shopper":case"About":case"Inventory":case"Online":return t.toLowerCase();default:return"recipes"}}()],mode:"horizontal"},r.a.createElement(q.a.Item,{key:"recipes"},J,"Recipes"),r.a.createElement(q.a.Item,{key:"planner"},K,"Planner"),r.a.createElement(q.a.Item,{key:"shopper"},r.a.createElement(v.a,{type:"shopping",theme:"twoTone"}),"Shopper"),r.a.createElement(q.a.Item,{key:"inventory"},r.a.createElement(v.a,{type:"pic-right"}),"Inventory"),r.a.createElement(q.a.Item,{key:"reports"},r.a.createElement(v.a,{type:"align-left"}),"Reports"),r.a.createElement(q.a.Item,{key:"importexport"},r.a.createElement(v.a,{type:"setting"}),"Import/Export"),r.a.createElement(q.a.Item,{key:"online"},r.a.createElement(v.a,{type:"wechat"}),"Communicate"),r.a.createElement(q.a.Item,{key:"about"},r.a.createElement(v.a,{type:"question"}),"About"))}}]),t}(r.a.Component),W=(n(408),n(24)),H=n.n(W);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q=function(e){var t=H.a.read(e,{type:"array"}),n=H.a.utils.sheet_to_json(t.Sheets.Recipes);window.foodnet.recipes=n.map((function(e){return Z({},e,{ingredients:JSON.parse(e.ingredientsJson)})}));var a=H.a.utils.sheet_to_json(t.Sheets.Ingredients);window.foodnet.ingredients=a.map((function(e){return Z({},e,{tags:e.tagsJson?JSON.parse(e.tagsJson):[]})})),window.foodnet.measurements=H.a.utils.sheet_to_json(t.Sheets.Measurements),window.foodnet.events=H.a.utils.sheet_to_json(t.Sheets.Events);var r=H.a.utils.sheet_to_json(t.Sheets.Config);r.length>0&&(window.foodnet.family=r[0].familyName),window.foodnet.sync()},G=n(457),X=(n(415),n(48)),$=n.n(X),ee=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={filename:"backup.xlsx",allowedFileExtensions:["xlsx","xlsm","xlsb","xml","xls","xlw","csv","txt","dif","sylk","slk","prn","ods","fods","dbf","eth"].map((function(e){return"."+e}))},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return window.File&&window.FileReader&&window.FileList&&window.Blob?r.a.createElement("div",{className:"import-export"},r.a.createElement(y.a,{onClick:function(){return e.setState({saveModal:!0})}},"Export To Excel"),r.a.createElement(y.a,{onClick:function(){return e.setState({loadModal:!0})}},"Import From Excel"),r.a.createElement(y.a,{onClick:function(){return e.setState({urlModal:!0})}},"Import From Url (Excel)"),this.state.saveModal&&r.a.createElement(x.a,{className:"save-modal",visible:!0,onCancel:function(){return e.setState({saveModal:!1})},onOk:function(){!function(e){var t=H.a.utils.book_new(),n=function(e){return e.ingredients.map((function(e){return Z({},e,{name:window.foodnet.ingredients.find((function(t){return t.id===e.id})).name})}))};H.a.utils.book_append_sheet(t,H.a.utils.json_to_sheet(window.foodnet.recipes.map((function(e){return Z({},e,{ingredientsJson:JSON.stringify(n(e))})}))),"Recipes"),H.a.utils.book_append_sheet(t,H.a.utils.json_to_sheet(window.foodnet.ingredients.map((function(e){return Z({},e,{tagsJson:JSON.stringify(e.tags||[])})}))),"Ingredients"),H.a.utils.book_append_sheet(t,H.a.utils.json_to_sheet(window.foodnet.measurements),"Measurements"),H.a.utils.book_append_sheet(t,H.a.utils.json_to_sheet(window.foodnet.events),"Events"),H.a.utils.book_append_sheet(t,H.a.utils.json_to_sheet([{familyName:window.foodnet.family}]),"Config"),H.a.writeFile(t,e||"foodnet.xlsx")}(e.getFilename()),e.setState({saveModal:!1})}},r.a.createElement(D.a.Item,{label:"File Name"},r.a.createElement(h.a,{value:this.state.filename,onChange:function(t){return e.setState({filename:t.target.value})}}))),this.state.loadModal&&r.a.createElement(x.a,{className:"load-modal",visible:!0,onCancel:function(){return e.setState({loadModal:!1})},okButtonProps:{disabled:!this.state.file},onOk:function(){var t=new FileReader;t.onload=function(e){Q(e.target.result)},t.readAsArrayBuffer(e.state.file),e.setState({loadModal:!1})}},r.a.createElement(D.a.Item,{label:""},r.a.createElement(h.a,{type:"file",id:"file",name:"file",accept:this.state.allowedFileExtensions.join(","),onChange:function(t){e.setState({file:t.target.files[0]})}}))),this.state.urlModal&&this.urlModal()):r.a.createElement("div",null,"Error: your browser does not support the File API specification. It is required for long term storage.")}},{key:"urlModal",value:function(){var e=this,t=function(){return!(!e.state.url||0===e.state.url.length)&&(!e.state.urlError&&(!!e.state.url.startsWith("http")&&-1!==e.state.url.indexOf("://")))};return r.a.createElement(x.a,{className:"url-modal",visible:!0,onCancel:function(){return e.setState({urlModal:!1})},okButtonProps:{disabled:!t()},onOk:function(){$.a.get(function(e){if(e&&e.indexOf("www.dropbox.com"))return e.replace("www.dropbox.com","dl.dropboxusercontent.com")}(e.state.url),{responseType:"arraybuffer"}).then((function(t){if(200!==t.status)e.setState({urlError:"".concat(t.status?t.response.status+" - ":"").concat(t.statusText?t.response.statusText+": ":"").concat(t.data||"")});else try{Q(t.data),-1===window.foodnet.importUrls.indexOf(e.state.url)&&(window.foodnet.importUrls.push(e.state.url),window.foodnet.sync()),e.setState({urlModal:void 0,url:void 0})}catch(n){console.log(n),e.setState({urlError:"Could not parse file: "+n})}})).catch((function(t){console.log(t),t.response||(t.response={statusText:"error: CORS blocking"}),console.log("".concat(t.response.status?t.response.status+" - ":"").concat(t.response.statusText?t.response.statusText+": ":"").concat(t.response.data||"")),e.setState({urlError:"".concat(t.response.status?t.response.status+" - ":"").concat(t.response.statusText?t.response.statusText:"")})}))}},r.a.createElement(D.a.Item,{label:"Remote URL",validateStatus:t()?"success":"error",help:this.state.urlError||(e.state.url&&0!==e.state.url.length?e.state.urlError?void 0:e.state.url.startsWith("http")?-1===e.state.url.indexOf("://")?"URL is not in the correct format (i.e. http://example.com)":void 0:"URL must begin with http or https":"Cannot be blank")},r.a.createElement(G.a,{style:{width:200},value:this.state.url,onChange:function(t){e.setState({url:t,urlError:void 0})}},window.foodnet.importUrls.map((function(e){return r.a.createElement(G.a.Option,{key:e},e)}))),r.a.createElement(y.a,{className:"url-delete-button",onClick:function(){window.foodnet.importUrls=window.foodnet.importUrls.filter((function(t){return t!==e.state.url})),window.foodnet.sync(),e.setState({url:void 0})},icon:"delete",disabled:!this.state.url})))}},{key:"getFilename",value:function(){var e=this.state.filename;for(var t in this.state.allowedFileExtensions)if(e.endsWith(this.state.allowedFileExtensions[t]))return e;return e+".xlsx"}}]),t}(r.a.Component),te=(n(432),n(443)),ne=n(452),ae=n(450),re=te.a.Sider,oe=te.a.Content,ie=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={menu:"r1"},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(te.a,{className:"reports-layout"},r.a.createElement(re,{collapsible:!0},this.renderMenu()),r.a.createElement(oe,null,this.renderSelectedMenuItem()))}},{key:"renderSelectedMenuItem",value:function(){switch(this.state.menu){case"r1":return this.renderCookingReferenceReport();case"r1p2":return this.renderCookingReferenceReportPage2();case"r2":return this.renderTopFavoritesReport();default:return}}},{key:"renderMenu",value:function(){var e=this;return r.a.createElement(q.a,{onClick:function(t){return e.setState({menu:t.key})},defaultSelectedKeys:["r1"],defaultOpenKeys:["r"],mode:"inline",style:{height:"100%"}},r.a.createElement(q.a.SubMenu,{key:"r",title:r.a.createElement("span",null,r.a.createElement(v.a,{type:"heart",theme:"twoTone",twoToneColor:"#eb2f96"}),r.a.createElement("span",null,"Recipe Reports"))},r.a.createElement(q.a.Item,{key:"r1"},"Cooking Reference"),r.a.createElement(q.a.Item,{key:"r2"},"Top Favorites")))}},{key:"renderCookingReferenceReport",value:function(){var e=this,t=function(t){t&&1===t.length&&"0-0"===t[0]?e.setState({r1checkedKeys:window.foodnet.recipes.map((function(e){return e.id.toString()}))}):e.setState({r1checkedKeys:t})};return r.a.createElement("div",{className:"recipe-select"},r.a.createElement(ne.a,{checkable:!0,onSelect:function(e){return t(e)},onCheck:function(e){return t(e)},expandedKeys:["0-0"],checkedKeys:this.state.r1checkedKeys},r.a.createElement(ne.a.TreeNode,{title:"All Recipes",key:"0-0"},window.foodnet.recipes.map((function(e){return r.a.createElement(ne.a.TreeNode,{title:e.name,key:e.id})})))),r.a.createElement(y.a,{disabled:!this.state.r1checkedKeys||this.state.r1checkedKeys.length<1,onClick:function(){e.setState({menu:"r1p2"})}},"Generate Report"))}},{key:"renderCookingReferenceReportPage2",value:function(){var e=this;return r.a.createElement("div",{className:"recipe-report"},window.foodnet.recipes.filter((function(t){return-1!==e.state.r1checkedKeys.indexOf(t.id.toString())})).map((function(e){return r.a.createElement(ae.a,{key:e.id,size:"small"},r.a.createElement("div",{className:"recipe",key:e.id},r.a.createElement("div",{className:"recipe-name"},"Recipe Name:"),r.a.createElement("div",null,e.name),r.a.createElement("div",{className:"desc-header"},"Instructions:"),r.a.createElement("div",{className:"desc-body"},e.desc||"None"),r.a.createElement("div",{className:"ing"},"Ingredients:"),r.a.createElement("div",{className:"ingredient-list"},e.ingredients.map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement("div",null,window.foodnet.ingredients.find((function(t){return t.id===e.id})).name,", ",e.qty," ",window.foodnet.measurements.find((function(t){return t.id===e.type})).name))})))))})))}},{key:"renderTopFavoritesReport",value:function(){return r.a.createElement("div",null,"Coming Soon")}}]),t}(r.a.Component),se=(n(433),n(102)),ce=n(455),le=n(93),de=n(456),ue=n(454),fe=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={mode:"list",listDays:Number.isInteger(window.foodnet.listDays)?window.foodnet.listDays:7},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"planner"},this.renderToolbar(),"calendar"===this.state.mode&&this.renderCalendar(),"list"===this.state.mode&&this.renderList()),this.renderAddListItemModal())}},{key:"renderToolbar",value:function(){var e=this;return r.a.createElement("div",{className:"planner-toolbar"},r.a.createElement(se.a.Group,{onChange:function(t){return e.setState({mode:t.target.value})},value:this.state.mode},r.a.createElement(se.a,{value:"list"},"List View"),r.a.createElement(se.a,{value:"calendar"},"Calendar View")),"list"===this.state.mode&&r.a.createElement(h.a,{type:"number",value:this.state.listDays,onChange:function(t){if(0===t.target.value.length)e.setState({listDays:void 0});else{var n=Number(t.target.value);n<0&&(n=0),e.setState({listDays:n}),window.foodnet.listDays=n,window.foodnet.sync()}}}))}},{key:"renderAddListItemModal",value:function(){var e=this,t=function(){return e.state.recipe},n=function(){e.state.eventid?window.foodnet.events=window.foodnet.events.filter((function(t){return t.id!==e.state.eventid})).concat({id:e.state.eventid,date:S()().add(e.state.dayOffset,"days").format(),qty:Number(e.state.qty||1),recipe:e.state.recipe}):window.foodnet.events.push({id:0===window.foodnet.events.length?1:Math.max.apply(Math,Object(T.a)(window.foodnet.events.map((function(e){return e.id}))))+1,date:S()().add(e.state.dayOffset,"days").format(),qty:Number(e.state.qty||1),recipe:e.state.recipe}),window.foodnet.sync(),e.setState({eventid:void 0,recipe:void 0,qty:void 0,dayOffset:void 0,modal:void 0})};return("add-list-item"===this.state.modal||"edit-list-item"===this.state.modal)&&r.a.createElement(x.a,{className:"list-item-modal",visible:!0,onCancel:function(){return e.setState({modal:void 0})},footer:["edit-list-item"===this.state.modal&&r.a.createElement(y.a,{key:"delete",type:"danger",onClick:function(){window.foodnet.events=window.foodnet.events.filter((function(t){return t.id!==e.state.eventid})),window.foodnet.sync(),e.setState({eventid:void 0,recipe:void 0,qty:void 0,dayOffset:void 0,modal:void 0})}},"Delete Event"),r.a.createElement(y.a,{key:"back",onClick:function(){return e.setState({modal:void 0})}},"Cancel"),r.a.createElement(y.a,{key:"submit",type:"primary",disabled:!t(),onClick:function(){return n()}},"OK")]},r.a.createElement(D.a,{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:12}}},r.a.createElement(D.a.Item,{validateStatus:t()?"success":"error",hasFeedback:!0,label:"Recipe"},r.a.createElement(P.a,{value:this.state.recipe,onChange:function(t){return e.setState({recipe:Number(t)})}},window.foodnet.recipes.map((function(t){return r.a.createElement(P.a.Option,{key:t.id,value:t.id,className:e.recipeHasInventory(t.id,1,e.state.dayOffset)?"has-inventory":"no-inventory"},t.name)})))),r.a.createElement(D.a.Item,{label:"Quantity",validateStatus:this.recipeHasInventory(this.state.recipe,this.state.qty,this.state.dayOffset)?"success":"error",hasFeedback:!0},r.a.createElement(h.a,{autoFocus:!0,type:"number",defaultValue:1,value:this.state.qty,onChange:function(t){return e.setState({qty:t.target.value})},onPressEnter:function(){t()&&n()}}))))}},{key:"renderList",value:function(){var e=this,t=function(t){return r.a.createElement(ce.a,{key:t},r.a.createElement(ce.a.Item,{key:"top",color:"blue"},r.a.createElement("b",null,r.a.createElement("u",null,S()().add(t,"days").format("dddd (MMM D)")))),function(t){return window.foodnet.events.filter((function(e){return S()().add(t,"days").format("Y-M-D")===S()(e.date).format("Y-M-D")})).sort((function(e,t){return e.id<t.id?-1:1})).map((function(n){return r.a.createElement(ce.a.Item,{key:n.id,color:e.recipeHasInventory(n.recipe,n.qty,t)?"green":"red",onClick:function(){e.setState({eventid:n.id,modal:"edit-list-item",dayOffset:t,recipe:n.recipe,qty:n.qty})}},n.qty," x ",window.foodnet.recipes.find((function(e){return e.id===n.recipe})).name)}))}(t),function(t){return r.a.createElement(ce.a.Item,{key:"add",onClick:function(){e.setState({eventid:void 0,modal:"add-list-item",dayOffset:t,recipe:void 0,qty:void 0})},dot:r.a.createElement(v.a,{type:"plus-circle",theme:"twoTone",twoToneColor:"red"})},"Add")}(t))};return r.a.createElement("div",{className:"planner-list"},Array.from(Array(this.state.listDays)).map((function(e,n){return t(n)})))}},{key:"recipeHasInventory",value:function(e,t,n){if(!e)return!1;var a={},r=window.foodnet;r.ingredients.forEach((function(e){e.qty&&Number(e.qty)>0&&(a["".concat(e.id,"-").concat(e.type)]=e.qty)}));var o=S()().startOf("day"),i=S()().endOf("day").add(n-1,"days");r.events.filter((function(e){return S()(e.date).isBetween(o,i)})).forEach((function(e){r.recipes.find((function(t){return t.id===e.recipe})).ingredients.forEach((function(t){var n=t.qty*e.qty;a["".concat(t.id,"-").concat(t.type)]?a["".concat(t.id,"-").concat(t.type)]-=n:a["".concat(t.id,"-").concat(t.type)]=-n}))}));for(var s=r.recipes.find((function(t){return t.id===e})).ingredients,c=0;c<s.length;c++){var l=s[c];if(l.qty*(t||1)>(a["".concat(l.id,"-").concat(l.type)]||0))return!1}return!0}},{key:"renderCalendar",value:function(){var e=this;return r.a.createElement(ue.a,{mode:this.state.calMode||"month",onPanelChange:function(t,n){return e.setState({calMode:n})},dateCellRender:function(t){var n=window.foodnet.events.filter((function(e){return S()(e.date).format("Y-M-D")===t.format("Y-M-D")})).map((function(t){var n="".concat(t.qty," x ").concat(window.foodnet.recipes.find((function(e){return e.id===t.recipe})).name),a=S()(t.date).startOf("day").diff(S()().startOf("day"),"days");return{eid:t.id,dayOffset:a,type:a<0?"success":e.recipeHasInventory(t.recipe,t.qty,a)?"success":"error",content:r.a.createElement(le.a,{placement:"top",title:n},n)}}));return r.a.createElement("ul",{className:"events"},n.map((function(t){return r.a.createElement("li",{key:t.eid},r.a.createElement(de.a,{onClick:function(n){var a=window.foodnet.events.find((function(e){return e.id===t.eid})),r=t.dayOffset;e.setState({eventid:a.id,modal:"edit-list-item",dayOffset:r,recipe:a.recipe,qty:a.qty}),n.stopPropagation()},status:t.type,text:t.content}))})))},monthCellRender:function(e){return window.foodnet.events.filter((function(t){return S()(t.date).month()===e.month()&&S()(t.date).year()===e.year()})).length+" recipes"},onSelect:function(t){if("year"!==e.state.calMode){var n=t.startOf("day").diff(S()().startOf("day"),"days");e.setState({eventid:void 0,modal:"add-list-item",dayOffset:n,recipe:void 0,qty:void 0})}else e.setState({calMode:"month"})}})}}]),t}(r.a.Component),me=(n(434),n(449)),pe=n(95),he=n(445),ye=n(223),ve=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={tagColors:["blue","green","red","orange","cyan","purple"]},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=function(){var t=e.state.inputValue;e.setState({inputVisible:!1,inputValue:""}),t&&t.trim().length>0&&e.props.add(t.trim())};return r.a.createElement("div",{className:this.props.className||""},this.props.tags.map((function(t,n){var a=t.length>20,o=r.a.createElement(ye.a,{key:t,color:e.state.tagColors[n%e.state.tagColors.length],closable:!0,onClose:function(){return e.props.remove(t)}},a?"".concat(t.slice(0,20),"..."):t);return a?r.a.createElement(le.a,{title:t,key:t},o):o})),this.state.inputVisible&&r.a.createElement(h.a,{ref:function(t){return e.input=t},type:"text",size:"small",style:{width:78},value:this.state.inputValue,onChange:function(t){return e.setState({inputValue:t.target.value})},onBlur:t,onPressEnter:t}),!this.state.inputVisible&&r.a.createElement(ye.a,{onClick:function(){return e.setState({inputVisible:!0},(function(){return e.input.focus()}))},style:{background:"#fff",borderStyle:"dashed"}},r.a.createElement(v.a,{type:"plus"})," New Tag"))}}]),t}(r.a.Component),ge=n(71);if("undefined"!==typeof Element&&!Element.prototype.matches){var we=Element.prototype;we.matches=we.matchesSelector||we.mozMatchesSelector||we.msMatchesSelector||we.oMatchesSelector||we.webkitMatchesSelector}var be=function(e,t,n){for(var a=e;a;){var r=a===n||a===document.body;if(r||1===a.nodeType&&a.matches(t)){r&&(a=null);break}a=a.parentNode}return a},Ee=function(e,t){return Array.from(e.parentNode.children).filter((function(e){return""===t||!e.matches(t)})).indexOf(e)},ke={TOP:1,BOTTOM:3},Oe=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(f.a)(t).call(this,e))).onMouseDown=n.onMouseDown.bind(Object(ge.a)(n)),n.onDragStart=n.onDragStart.bind(Object(ge.a)(n)),n.onDragEnter=n.onDragEnter.bind(Object(ge.a)(n)),n.onDragEnd=n.onDragEnd.bind(Object(ge.a)(n)),n.autoScroll=n.autoScroll.bind(Object(ge.a)(n)),n.state={fromIndex:-1,toIndex:-1},n.scrollElement=null,n.scrollTimerId=-1,n.direction=ke.BOTTOM,n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentWillUnmount",value:function(){this.dragLine&&this.dragLine.parentNode&&(this.dragLine.parentNode.removeChild(this.dragLine),this.dragLine=null,this.cacheDragTarget=null)}},{key:"onMouseDown",value:function(e){var t=this.getHandleNode(e.target);if(t){var n=this.props.handleSelector&&this.props.handleSelector!==this.props.nodeSelector?this.getDragNode(t):t;n&&(t.setAttribute("draggable",!1),n.setAttribute("draggable",!0),n.ondragstart=this.onDragStart,n.ondragend=this.onDragEnd)}}},{key:"onDragStart",value:function(e){var t=this.getDragNode(e.target),n=e;if(t){var a=t.parentNode;n.dataTransfer.setData("Text",""),n.dataTransfer.effectAllowed="move",a.ondragenter=this.onDragEnter,a.ondragover=function(e){return e.preventDefault(),!0};var r=Ee(t,this.props.ignoreSelector);this.setState({fromIndex:r,toIndex:r}),this.scrollElement=function(e){var t=e;do{var n=window.getComputedStyle(t).overflow;if(("auto"===n||"scroll"===n)&&t&&t.nodeType&&(t.offsetWidth<t.scrollWidth||t.offsetHeight<t.scrollHeight))break;if(!t||!t.nodeType||t===document.body){t=null;break}t=t.parentNode}while(t);return t}(a)}}},{key:"onDragEnter",value:function(e){var t,n=this.getDragNode(e.target),a=e;n?(t=Ee(n,this.props.ignoreSelector),this.props.enableScroll&&this.resolveAutoScroll(a,n)):(t=-1,this.stopAutoScroll()),this.cacheDragTarget=n,this.setState({toIndex:t}),this.fixDragLine(n)}},{key:"onDragEnd",value:function(e){var t=this.getDragNode(e.target);this.stopAutoScroll(),t&&(t.removeAttribute("draggable"),t.ondragstart=null,t.ondragend=null,t.parentNode.ondragenter=null,t.parentNode.ondragover=null,this.state.fromIndex>=0&&this.state.fromIndex!==this.state.toIndex&&this.props.onDragEnd(this.state.fromIndex,this.state.toIndex)),this.hideDragLine(),this.setState({fromIndex:-1,toIndex:-1})}},{key:"getDragNode",value:function(e){return be(e,this.props.nodeSelector,this.dragList)}},{key:"getHandleNode",value:function(e){return be(e,this.props.handleSelector||this.props.nodeSelector,this.dragList)}},{key:"getDragLine",value:function(){return this.dragLine||(this.dragLine=window.document.createElement("div"),this.dragLine.setAttribute("style","position:fixed;z-index:9999;height:0;margin-top:-1px;border-bottom:dashed 2px red;display:none;"),window.document.body.appendChild(this.dragLine)),this.dragLine.className=this.props.lineClassName||"",this.dragLine}},{key:"resolveAutoScroll",value:function(e,t){if(this.scrollElement){var n=this.scrollElement.getBoundingClientRect(),a=n.top,r=n.height,o=t.offsetHeight,i=e.pageY,s=o*(2/3);this.direction=0,i>a+r-s?this.direction=ke.BOTTOM:i<a+s&&(this.direction=ke.TOP),this.direction?this.scrollTimerId<0&&(this.scrollTimerId=setInterval(this.autoScroll,20)):this.stopAutoScroll()}}},{key:"stopAutoScroll",value:function(){clearInterval(this.scrollTimerId),this.scrollTimerId=-1,this.fixDragLine(this.cacheDragTarget)}},{key:"autoScroll",value:function(){var e=this.scrollElement.scrollTop;this.direction===ke.BOTTOM?(this.scrollElement.scrollTop=e+this.props.scrollSpeed,e===this.scrollElement.scrollTop&&this.stopAutoScroll()):this.direction===ke.TOP?(this.scrollElement.scrollTop=e-this.props.scrollSpeed,this.scrollElement.scrollTop<=0&&this.stopAutoScroll()):this.stopAutoScroll()}},{key:"hideDragLine",value:function(){this.dragLine&&(this.dragLine.style.display="none")}},{key:"fixDragLine",value:function(e){var t=this.getDragLine();if(!e||this.state.fromIndex<0||this.state.fromIndex===this.state.toIndex)this.hideDragLine();else{var n=e.getBoundingClientRect(),a=n.left,r=n.top,o=n.width,i=n.height,s=this.state.toIndex<this.state.fromIndex?r:r+i;if(this.props.enableScroll&&this.scrollElement){var c=this.scrollElement.getBoundingClientRect(),l=c.height,d=c.top;if(s<d-2||s>d+l+2)return void this.hideDragLine()}t.style.left=a+"px",t.style.width=o+"px",t.style.top=s+"px",t.style.display="block"}}},{key:"render",value:function(){var e=this;return r.a.createElement("div",Object.assign({role:"presentation"},{onTouchStart:function(e){}},{onMouseDown:this.onMouseDown,ref:function(t){e.dragList=t}}),this.props.children)}}]),t}(a.Component);Oe.defaultProps={nodeSelector:"tr",ignoreSelector:"",enableScroll:!0,scrollSpeed:10,handleSelector:"",lineClassName:"",children:null};var Se=Oe,Ce=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=function(){e.setState({value:void 0})};return r.a.createElement(h.a,Object.assign({},this.props,{value:""===this.state.value?this.state.value:this.props.value||this.state.value||this.props.defaultValue,onChange:function(t){return function(t){e.setState({value:t.target.value})}(t)},onPressEnter:function(n){t(),""!==n.target.value&&n.target.value!=e.props.defaultValue&&e.props.onPressEnter(n)},onBlur:function(n){t(),""!==n.target.value&&n.target.value!=e.props.defaultValue&&e.props.onBlur(n)}}))}}]),t}(r.a.Component),je=n(444);function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xe=me.a.RangePicker,Te=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={checkedItems:[],filteredTags:[],MULTIPLIER:4},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.setState({dates:window.foodnet.plannerDates&&2===window.foodnet.plannerDates.length?window.foodnet.plannerDates.map((function(e){return S()(e)})):void 0,checkedItems:window.foodnet.plannerCheckedItems||[],customSort:window.foodnet.customSort,customSortOrder:window.foodnet.customSortOrder})}},{key:"render",value:function(){var e=this,t=function(t,n){var a=e.state.filteredTags;a=n?a.concat(t):a.filter((function(e){return e!==t})),e.setState({filteredTags:a})},n=this.getTags(),a=function(){return[r.a.createElement(q.a.Item,{key:"_NO_TAG"},r.a.createElement(pe.a,{onChange:function(e){return t("_NO_TAG",e.target.checked)}},"Untagged"))].concat(n.map((function(e){return r.a.createElement(q.a.Item,{key:e},r.a.createElement(pe.a,{onChange:function(n){return t(e,n.target.checked)}},e))})))},o=function(t,a){var r=Object(T.a)(n),o=r.splice(t/e.state.MULTIPLIER,1)[0];r.splice(a/e.state.MULTIPLIER,0,o),e.setState({customSortOrder:r})},i=function(t,a){if(Number(t)!==a){var r=a-1,i=Number(t)-1;i>=n.length&&(i=n.length-1),o(r*e.state.MULTIPLIER,i*e.state.MULTIPLIER)}};return r.a.createElement("div",{className:"shopper"},r.a.createElement("div",{className:"buttons"},r.a.createElement(y.a,{disabled:!n||0===n.length,onClick:function(){return e.setState({modal:"sort"})}},"Sort by Tags"),r.a.createElement(M.a,{disabled:1===a().length,onVisibleChange:function(t){return e.setState({dropdownvisible:t})},visible:this.state.dropdownvisible,trigger:["click"],overlay:r.a.createElement(q.a,null,a())},r.a.createElement(y.a,null,"Filter by Tags")),r.a.createElement(y.a,{onClick:function(){return e.setState({hideTags:!e.state.hideTags})}},this.state.hideTags?"Show Tags":"Hide Tags"),r.a.createElement(y.a,{onClick:function(){return e.setState({hideZero:!e.state.hideZero})}},this.state.hideZero?"Show Zeros":"Hide Zeroes")),r.a.createElement(xe,{value:this.state.dates,onChange:function(t){e.setState({dates:t,checkedItems:[]}),window.foodnet.plannerDates=t.map((function(e){return e.format()})),window.foodnet.plannerCheckedItems=[],window.foodnet.sync()}}),this.state.dates&&r.a.createElement(r.a.Fragment,null,this.renderIngredientList(),r.a.createElement(y.a,{className:"copy-to-inventory-button",onClick:function(){var t=e.createIngredientList(),n=window.foodnet;t.forEach((function(e){var t=n.ingredients.find((function(t){return t.id===e.id}));if(t.type||(t.type=e.type),t.type!==e.type){var a=function(e){return n.measurements.find((function(t){return t.id===e})).name};je.a.error({message:"Error: Measurement type mismatch",description:"Ingredient: ".concat(e.name,", types: from ").concat(a(e.type)," to ").concat(a(t.type)),duration:0})}else void 0===t.qty&&(t.qty=0),t.qty=Number(t.qty),t.qty+=Number(e.qty||1),n.sync()})),N.a.info("Done copying"),e.forceUpdate()}},"==== COPY DISPLAYED TO INVENTORY ===>")),"sort"===this.state.modal&&r.a.createElement(x.a,{className:"sort-popup",visible:!0,onCancel:function(){e.setState({modal:void 0,customSort:window.foodnet.customSort,customSortOrder:window.foodnet.customSortOrder})},onOk:function(){window.foodnet.customSort=e.state.customSort,window.foodnet.customSortOrder=e.state.customSortOrder,window.foodnet.sync(),e.setState({modal:void 0})}},r.a.createElement("div",null,r.a.createElement(he.a,{checked:this.state.customSort,onChange:function(t){e.setState({customSort:t,customSortOrder:n})}})," Enable Tag Sorting"),r.a.createElement(Se,{onDragEnd:o,nodeSelector:"span",handleSelector:"span"},r.a.createElement("div",{className:"drag-list"},n.map((function(t,n){return r.a.createElement(r.a.Fragment,{key:n},r.a.createElement(Ce,{type:"number",min:"1",max:"9999",defaultValue:n+1,onPressEnter:function(e){return i(e.target.value,n+1)},onBlur:function(e){return i(e.target.value,n+1)}}),r.a.createElement(ye.a,null,t),r.a.createElement(v.a,{className:"up",type:"up",onClick:function(){return o(n*e.state.MULTIPLIER,n*e.state.MULTIPLIER-e.state.MULTIPLIER)}}),r.a.createElement(v.a,{className:"down",type:"down",onClick:function(){return o(n*e.state.MULTIPLIER,n*e.state.MULTIPLIER+e.state.MULTIPLIER)}}))}))))))}},{key:"getTags",value:function(){var e=[];if(window.foodnet.ingredients.forEach((function(t){(t.tags||[]).forEach((function(t){-1===e.indexOf(t)&&(e=e.concat(t))}))})),(this.state.filteredTags||[]).forEach((function(t){-1===e.indexOf(t)&&(e=e.concat(t))})),e=e.sort((function(e,t){return e.localeCompare(t)})),this.state.customSort&&this.state.customSortOrder&&this.state.customSortOrder.length>0){var t=this.state.customSortOrder;e=e.sort((function(e,n){var a=t.indexOf(e),r=t.indexOf(n);return-1!==a||-1!==r?-1!==a&&-1!==r?a<r?-1:1:-1===a?-1:1:0}))}return e}},{key:"createIngredientList",value:function(){var e=this,t=window.foodnet,n=[];t.events.forEach((function(a){var r;if((r=S()(a.date)).isBetween.apply(r,Object(T.a)(e.state.dates).concat(["days","[]"]))){var o=Number(a.qty)||0;t.recipes.find((function(e){return e.id===a.recipe})).ingredients.forEach((function(e){n.push({id:e.id,type:e.type,qty:Number(e.qty)*o})}))}}));n=(n=n.sort((function(e,t){return e.id!==t.id?e.id<t.id?-1:1:e.type!==t.type?e.type<t.type?-1:1:0})).map((function(e,t,n){if(t>0&&n[t-1].id===e.id&&n[t-1].type===e.type){for(var a=t-1;n[a].deleted;)a--;n[a].qty+=e.qty,e.deleted=!0}return e})).filter((function(e){return!e.deleted}))).map((function(e){var n=t.ingredients.find((function(t){return t.id===e.id&&t.type===e.type}));if(n&&n.qty&&n.qty>0){var a=Number(e.qty)-Number(n.qty);return a<0&&(a=0),Ne({},e,{qty:a,deducted:!0})}return e})).filter((function(t){return!e.state.hideZero||t.qty>0}));var a=this.getTags();return n.map((function(n){return Ne({},n,{name:t.ingredients.find((function(e){return e.id===n.id})).name,typename:t.measurements.find((function(e){return e.id===n.type})).name,checked:-1!==e.state.checkedItems.indexOf(n.id),tags:t.ingredients.find((function(e){return e.id===n.id})).tags||[]})})).sort((function(e,t){return e.name.localeCompare(t.name)||e.typename.localeCompare(t.typename)})).filter((function(t){if(0===e.state.filteredTags.length)return!0;var n=t.tags;0===n.length&&(n=["_NO_TAG"]);var a=!1;return n.forEach((function(t){e.state.filteredTags.forEach((function(e){t===e&&(a=!0)}))})),a})).sort((function(t,n){if(!e.state.customSort)return 0;if(!t.tags||!n.tags||0===t.tags.length||0===n.tags.length)return t.tags&&0!==t.tags.length||n.tags&&0!==n.tags.length?t.tags&&0!==t.tags.length?-1:1:0;var r=function(e){return e.reduce((function(e,t){if(!t)return e;var n=a.indexOf(e),r=a.indexOf(t);return-1===n||-1===r?-1===n&&-1===r?t:-1===n?t:e:n<r?e:t}))},o=r(t.tags),i=r(n.tags),s=a.indexOf(o),c=a.indexOf(i);return-1!==s||-1!==c?-1!==s&&-1!==c?s<c?-1:1:-1===s?-1:1:0}))}},{key:"renderIngredientList",value:function(){var e=this,t=window.foodnet,n=this.createIngredientList();return r.a.createElement("ul",{className:"ingredient-list"},n.map((function(n,a){return r.a.createElement("li",{key:a,className:"shopper-list-items"},r.a.createElement(pe.a,{className:"shopper-list-item",key:a,checked:n.checked,onChange:function(a){t.plannerCheckedItems=t.plannerCheckedItems.filter((function(e){return e!==n.id})),a.target.checked&&(t.plannerCheckedItems=t.plannerCheckedItems.concat(n.id)),e.setState({checkedItems:t.plannerCheckedItems}),t.sync()}},"".concat(n.name,": ").concat(n.qty," ").concat(n.typename)),n.deducted&&r.a.createElement(le.a,{title:"Adjusted from inventory",trigger:"click"},r.a.createElement(v.a,{className:"deduct-icon",type:"info-circle",theme:"twoTone",twoToneColor:"orange"})),!e.state.hideTags&&r.a.createElement(ve,{className:"shopper-tags",tags:n.tags,add:function(a){var r=t.ingredients.find((function(e){return e.id===n.id}));t.ingredients=t.ingredients.filter((function(e){return e.id!==n.id})).concat(Ne({},r,{tags:Object(T.a)(n.tags).concat(a)})),t.sync(),e.forceUpdate()},remove:function(a){var r=t.ingredients.find((function(e){return e.id===n.id}));t.ingredients=t.ingredients.filter((function(e){return e.id!==n.id})).concat(Ne({},r,{tags:Object(T.a)(n.tags).filter((function(e){return e!==a}))})),t.sync(),e.forceUpdate()}}))})))}}]),t}(r.a.Component),De=(n(436),n(446));function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var qe=me.a.RangePicker,Pe=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"findIngredientsUsedInEvents",value:function(){var e=window.foodnet,t=[],n=S()().startOf("day"),a=S()().endOf("day").add(e.listDays-1,"days");e.events.filter((function(e){return S()(e.date).isBetween(n,a)})).forEach((function(n){var a=Number(n.qty)||0;e.recipes.find((function(e){return e.id===n.recipe})).ingredients.forEach((function(e){t.push({id:e.id,type:e.type,qty:Number(e.qty)*a})}))}));return(t=t.sort((function(e,t){return e.id!==t.id?e.id<t.id?-1:1:e.type!==t.type?e.type<t.type?-1:1:0})).map((function(e,t,n){if(t>0&&n[t-1].id===e.id&&n[t-1].type===e.type){for(var a=t-1;n[a].deleted;)a--;n[a].qty+=e.qty,e.deleted=!0}return e})).filter((function(e){return!e.deleted}))).map((function(t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{name:e.ingredients.find((function(e){return e.id===t.id})).name,typename:e.measurements.find((function(e){return e.id===t.type})).name})})).sort((function(e,t){return e.name.localeCompare(t.name)||e.typename.localeCompare(t.typename)}))}},{key:"renderToolbar",value:function(){var e=this,t=function(t){return r.a.createElement(q.a,{className:"inventory-toolbar-dropdown-".concat(t),onClick:function(t){return n=t.key,void e.setState({modal:n});var n}},r.a.createElement(q.a.Item,{key:"".concat(t,"-recipe")},J,"Recipe"),r.a.createElement(q.a.Item,{key:"".concat(t,"-event")},K,"Event dates"))};return r.a.createElement("div",{className:"inventory-toolbar"},r.a.createElement(M.a,{overlay:t("add")},r.a.createElement(y.a,null,"Add from ...",r.a.createElement(v.a,{type:"down"}))),r.a.createElement(M.a,{overlay:t("remove")},r.a.createElement(y.a,null,"Deduct from ...",r.a.createElement(v.a,{type:"down"}))))}},{key:"renderModals",value:function(){var e=this,t={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:12}}},n=function(){var t=window.foodnet,n=[];return e.state.dates&&t.events.forEach((function(a){var r,o=[];if((r=S()(a.date)).isBetween.apply(r,Object(T.a)(e.state.dates).concat(["days","[]"]))){var i=Number(a.qty)||0,s=t.recipes.find((function(e){return e.id===a.recipe}));s.ingredients.forEach((function(e){o.push({id:e.id,type:e.type,qty:Number(e.qty)*i,name:t.ingredients.find((function(t){return t.id===e.id})).name})})),n.push({event:a,ilist:o,recipe:s})}})),n.sort((function(e,t){var n=S()(e.event.date).startOf("day"),a=S()(t.event.date).startOf("day");return n.isBefore(a)?-1:n.isAfter(a)?1:e.recipe.name.localeCompare(t.recipe.name)}))},a=function(){var t=e.state.modal;return"add-recipe"===t||"remove-recipe"===t?e.state.recipe&&e.state.recipe>0:e.state.dates&&e.state.dates.length>0&&n().length>0},o=function(){var t=e.state.modal,a=window.foodnet;if("add-recipe"===t||"remove-recipe"===t){var r=a.recipes.find((function(t){return t.id===e.state.recipe}));r.ingredients.forEach((function(n){var o=a.ingredients.find((function(e){return e.id===n.id}));if(o.type||(o.type=n.type),o.type!==n.type)je.a.error({message:"Error: Measurement type mismatch",description:"Recipe: "+r.name+", Ingredient: "+n.name,duration:0});else{var i=e.state.qty;void 0===o.qty&&(o.qty=0),o.qty=Number(o.qty),"add-recipe"===t?o.qty+=Number(n.qty||1)*Number(i||1):(o.qty-=Number(n.qty||1)*Number(i||1),o.qty<0&&(o.qty=0)),a.sync()}}))}else"add-event"!==t&&"remove-event"!==t||n().forEach((function(e){var n=e.recipe;e.ilist.forEach((function(e){var r=a.ingredients.find((function(t){return t.id===e.id}));if(r.type||(r.type=e.type),r.type!==e.type){var o=function(e){return a.measurements.find((function(t){return t.id===e})).name};je.a.error({message:"Error: Measurement type mismatch",description:"Recipe: ".concat(n.name,", Ingredient: ").concat(e.name,", type ").concat(o(e.type)," vs. ").concat(o(r.type)),duration:0})}else void 0===r.qty&&(r.qty=0),r.qty=Number(r.qty),"add-event"===t?r.qty+=Number(e.qty||1):(r.qty-=Number(e.qty||1),r.qty<0&&(r.qty=0)),a.sync()}))}));e.setState({modal:void 0,recipe:void 0,qty:void 0,dates:void 0})},i=function(){e.setState({modal:void 0,recipe:void 0,qty:void 0,dates:void 0})},s=function(e){return e.ilist.map((function(e,t){return r.a.createElement("div",{key:t},"".concat(e.name," - ").concat(e.qty," ").concat(window.foodnet.measurements.find((function(t){return t.id===e.type})).name))}))};return r.a.createElement(r.a.Fragment,null,("add-recipe"===this.state.modal||"remove-recipe"===this.state.modal)&&r.a.createElement(x.a,{width:"90%",visible:!0,keyboard:!0,onCancel:function(){return i()},onOk:function(){return o()},okButtonProps:{disabled:!a()}},r.a.createElement(D.a,t,r.a.createElement(D.a.Item,{validateStatus:a()?"success":"error",hasFeedback:!0,label:"Recipe"},r.a.createElement(P.a,{value:this.state.recipe,onChange:function(t){return e.setState({recipe:Number(t)})}},window.foodnet.recipes.map((function(e){return r.a.createElement(P.a.Option,{key:e.id,value:e.id},e.name)})))),r.a.createElement(D.a.Item,{label:"Quantity"},r.a.createElement(h.a,{autoFocus:!0,type:"number",defaultValue:1,value:this.state.qty,onChange:function(t){return e.setState({qty:t.target.value})},onPressEnter:function(){a()&&o()}})))),("add-event"===this.state.modal||"remove-event"===this.state.modal)&&r.a.createElement(x.a,{width:"90%",visible:!0,keyboard:!0,onCancel:function(){return i()},onOk:function(){return o()},okButtonProps:{disabled:!a()}},r.a.createElement(D.a,t,r.a.createElement(D.a.Item,{validateStatus:a()?"success":"error",hasFeedback:!0,label:"Event Dates"},r.a.createElement(qe,{value:this.state.dates,onChange:function(t){e.setState({dates:t})}})),r.a.createElement(D.a.Item,{label:"Events to ".concat("add-event"===this.state.modal?"add":"remove")},n().map((function(e){return r.a.createElement("div",{key:e.event.id},"".concat(e.event.qty," x "),r.a.createElement(De.a,{content:s(e)},r.a.createElement("a",{onClick:function(){}},"".concat(e.recipe.name)))," on ".concat(S()(e.event.date).format("MMM Do")))}))))))}},{key:"render",value:function(){var e=this,t=window.foodnet,n=function(n){return r.a.createElement(P.a,{className:"inventory-list-item-type",value:n.type,onChange:function(a){return function(n,a){a.type=n,t.sync(),e.forceUpdate()}(a,n)}},t.measurements.map((function(e){return r.a.createElement(P.a.Option,{key:e.id,value:e.id},e.name)})))},a=function(t,n){return e.setState({edit:t.id})},o=function(n,a){a.qty=n,t.sync(),e.forceUpdate()},i=this.findIngredientsUsedInEvents(),s=function(e){var t=i.find((function(t){return t.id===e.id&&t.type===e.type}));return t?e.qty<t.qty?" used-short":" used-good":""};return r.a.createElement("div",{className:"inventory"},this.renderToolbar(),r.a.createElement("div",{className:"inventory-list"},t.ingredients.map((function(i,c){return function(t){return e.state.edit===t.id}(i)?r.a.createElement(r.a.Fragment,{key:c},r.a.createElement("div",{className:"inventory-list-item-name"+s(i),onClick:function(){return e.setState({edit:void 0})}},i.name),r.a.createElement(Ce,{className:"inventory-list-item-qty",type:"number",min:"0",max:"9999",defaultValue:i.qty,onPressEnter:function(e){return o(e.target.value,i)},onBlur:function(e){return o(e.target.value,i)}}),n(i),r.a.createElement("div",{className:"inventory-list-item-deselect-div",onClick:function(){return e.setState({edit:void 0})}})):r.a.createElement(r.a.Fragment,{key:c},r.a.createElement("div",{className:"inventory-list-item-name"+s(i),onClick:function(e){return a(i)}},i.name),r.a.createElement("div",{className:"inventory-list-item-qty"+s(i),onClick:function(e){return a(i)}},i.qty||0),r.a.createElement("div",{className:"inventory-list-item-type"+s(i),onClick:function(e){return a(i)}},i.type?t.measurements.find((function(e){return e.id===i.type})).name:"(no measurement type)"),r.a.createElement("div",{className:"inventory-list-item-deselect-div",onClick:function(){return e.setState({edit:void 0})}}))}))),this.renderModals())}}]),t}(r.a.Component),Le=(n(437),2),Ae=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"about-page"},r.a.createElement(ae.a,null,this.createBlurb(),this.contact(),this.donate(),this.version()))}},{key:"createBlurb",value:function(){return r.a.createElement("blockquote",{className:"about-desc"},"The goal of this app is to make meal creation for yourself and your family easier, and to minimize the time spent doing so. This is a completely 100% client-side app capable of going offline. No ads, spyware, or other bullonky.")}},{key:"contact",value:function(){return r.a.createElement("div",{className:"email"},r.a.createElement("a",{href:"mailto://".concat("harry.h.bowyer@gmail.com","?").concat("subject=Foodnet Feedback","&").concat("body=Concerning your food app,%0A%0A%0A%0A")},"Contact Link (e-mail)"))}},{key:"donate",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("blockquote",{className:"donate-desc"},"Please consider buying me a coffee. It will help deprive me of sleep so that I can continue improving the app.",r.a.createElement("br",null),r.a.createElement("span",{className:"donate-desc-2"},"For now, email me using the link above if you wish to motivate me with material objects. Just knowing you are willing to do so helps. I'm in the process of figuring out how to filter funds through ",r.a.createElement("b",null,"The Man"),".")))}},{key:"version",value:function(){return r.a.createElement("div",null,"Version: ",1,".",Le)}}]),t}(r.a.Component),Re=n(39),Fe=n(447),_e=(n(438),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={message:"Connecting...",status:"init",family:Array.isArray(window.foodnet.family)?void 0:window.foodnet.family,authheader:{headers:{authorization:"Bot ".concat(Re.token2+Re.token1)}}},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.login()}},{key:"render",value:function(){var e=this,t={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:12}}},n=this.state.status;if("init"===n||"error"===n)return r.a.createElement(D.a,t,r.a.createElement(D.a.Item,{label:"Status"},r.a.createElement("div",{className:"message"},this.state.message)));var a=function(){if(e.state.family&&e.state.family.trim().length>0)return!0},o=function(){window.foodnet.family=e.state.family,window.foodnet.sync(),e.setState({message:"Connected. Searching for family file..."},(function(){return e.findFamilyFile()}))};return r.a.createElement("div",{className:"discord-tab"},(!window.foodnet.hideDiscordAlert||Array.isArray(window.foodnet.hideDiscordAlert)||S()().diff(S()(window.foodnet.hideDiscordAlert),"days")>7)&&r.a.createElement(Fe.a,{message:"Warning",description:"This functionality is not expected to be 100% reliable. It is mainly for quick communication between family members. Please export your backups to a file on a regular basis.",type:"warning",showIcon:!0,closable:!0,onClose:function(){window.foodnet.hideDiscordAlert=S()(),window.foodnet.sync()}}),r.a.createElement(D.a,t,r.a.createElement(D.a.Item,{label:"Status"},r.a.createElement("div",{className:"message"},this.state.message)),r.a.createElement(D.a.Item,{className:"wrap-label",label:"Enter shared family secret pass-phrase for syncing purposes"},r.a.createElement(h.a,{value:this.state.family,className:"family-input",onChange:function(t){return e.setState({family:t.target.value})},onPressEnter:function(){a()&&o()}}),r.a.createElement(y.a,{className:"family-input-button",onClick:function(){return o()},disabled:!a()||this.state.family==window.foodnet.family},"Update")),("found"===this.state.status||"not found"===this.state.status)&&r.a.createElement(D.a.Item,{label:"Sync"},r.a.createElement(k.a,{title:"Are you sure you want to sync this to your online storage?",onConfirm:function(){return e.upload()}},r.a.createElement(y.a,{className:"upload"},"Upload")),r.a.createElement(k.a,{title:"Are you sure you want to overwrite your local data with the online version?",onConfirm:function(){return e.download()},disabled:"not found"===this.state.status},r.a.createElement(y.a,{className:"download",disabled:"not found"===this.state.status},"Download")))))}},{key:"getToken",value:function(){return Re.token2+Re.token1}},{key:"login",value:function(){var e=this;$.a.get(Re.url+"/users/@me",this.state.authheader).then((function(){return e.afterLogin()})).catch((function(t){return e.setState({message:"Error: ".concat(t.message)})}))}},{key:"afterLogin",value:function(){var e=this;this.setState({message:"Connected.",status:"connected"},(function(){$.a.get(Re.url+"/users/@me/guilds",e.state.authheader).then((function(t){var n=t.data[0].id;$.a.get("".concat(Re.url,"/guilds/").concat(n,"/channels"),e.state.authheader).then((function(t){var n=t.data.find((function(e){return"foodnet"===e.name})).id;e.setState({channelId:n},(function(){window.foodnet.family&&!Array.isArray(window.foodnet.family)&&e.setState({message:"Connected. Searching for family file..."},(function(){return e.findFamilyFile()}))}))})).catch((function(t){return e.setState({message:"Error: ".concat(t.message)})}))})).catch((function(t){return e.setState({message:"Error: ".concat(t.message)})}))}))}},{key:"findFamilyFile",value:function(){var e=this,t=this.state,n=t.channelId,a=t.authheader;$.a.get("".concat(Re.url,"/channels/").concat(n,"/messages"),a).then((function t(r){var o=r.data;if(o.length>0){var i=o.find((function(e){return-1!==e.content.toLowerCase().indexOf("[".concat(window.foodnet.family.toLowerCase(),"]"))}));i?e.setState({message:"Connected. Backup available.",status:"found",serverMessage:i}):$.a.get("".concat(Re.url,"/channels/").concat(n,"/messages?before=").concat(o[o.length-1].id),a).then(t).catch((function(t){return e.setState({message:"Error: ".concat(t.message)})}))}else e.setState({message:"Connected. No backup available.",status:"not found"})})).catch((function(t){return e.setState({message:"Error: ".concat(t.message)})}))}},{key:"delete",value:function(){var e=this,t=this.state,n=t.channelId,a=t.authheader;$.a.get("".concat(Re.url,"/channels/").concat(n,"/messages"),a).then((function t(r){var o=r.data;o.length>0?(o.filter((function(e){return"FoodNet"===e.author.username})).filter((function(e){return-1!==e.content.toLowerCase().indexOf("[".concat(window.foodnet.family.toLowerCase(),"]"))})).forEach((function(t){$.a.delete("".concat(Re.url,"/channels/").concat(n,"/messages/").concat(t.id),a).catch((function(t){return e.setState({message:"Error: ".concat(t.message)})}))})),$.a.get("".concat(Re.url,"/channels/").concat(n,"/messages?before=").concat(o[o.length-1].id),a).then(t).catch((function(t){return e.setState({message:"Error: ".concat(t.message)})}))):e.uploadContinue()})).catch((function(t){return e.setState({message:"Error: ".concat(t.message)})}))}},{key:"upload",value:function(){this.delete()}},{key:"uploadContinue",value:function(){var e=this,t=this.state.channelId,n=function(){var e=H.a.utils.book_new(),t=function(e){return e.ingredients.map((function(e){return Z({},e,{name:window.foodnet.ingredients.find((function(t){return t.id===e.id})).name})}))};return H.a.utils.book_append_sheet(e,H.a.utils.json_to_sheet(window.foodnet.recipes.map((function(e){return Z({},e,{ingredientsJson:JSON.stringify(t(e))})}))),"Recipes"),H.a.utils.book_append_sheet(e,H.a.utils.json_to_sheet(window.foodnet.ingredients.map((function(e){return Z({},e,{tagsJson:JSON.stringify(e.tags||[])})}))),"Ingredients"),H.a.utils.book_append_sheet(e,H.a.utils.json_to_sheet(window.foodnet.measurements),"Measurements"),H.a.utils.book_append_sheet(e,H.a.utils.json_to_sheet(window.foodnet.events),"Events"),H.a.utils.book_append_sheet(e,H.a.utils.json_to_sheet([{familyName:window.foodnet.family}]),"Config"),H.a.write(e,{type:"array"})}(),a=new FormData,r=new Blob([n],{type:"application/octet-stream"});a.append("file",r,"wb.xlsx"),a.append("content","[".concat(window.foodnet.family,"]")),$.a.post("".concat(Re.url,"/channels/").concat(t,"/messages"),a,{headers:{authorization:"Bot ".concat(Re.token2+Re.token1),"Content-Type":"multipart/form-data"}}).then((function(){N.a.info("Saved"),e.findFamilyFile()})).catch((function(e){console.error(e),N.a.error(e.message)}))}},{key:"download",value:function(){var e=this.state.serverMessage;e.attachments&&e.attachments.length>0&&$.a.get("".concat("https://cors-anywhere.herokuapp.com/").concat(e.attachments[0].url),{responseType:"arraybuffer",headers:{Cookie:this.getToken()}}).then((function(e){var t=e.data;Q(new Uint8Array(t)),N.a.info("Loaded")})).catch((function(e){console.error(e),N.a.error(e.message)}))}}]),t}(r.a.Component));!function(){var e=["ingredients","measurements","recipes","listDays","events","importUrls","plannerDates","plannerCheckedItems","customSort","customSortOrder","family","hideDiscordAlert"];window.foodnet={sync:function(){e.forEach((function(e){return localStorage.setItem(e,JSON.stringify(window.foodnet[e]))}))}},e.forEach((function(e){try{window.foodnet[e]=JSON.parse(localStorage.getItem(e))}catch(t){console.error(t)}})),e.forEach((function(e){void 0!==window.foodnet[e]&&null!==window.foodnet[e]||(window.foodnet[e]=[])}))}();var Ue=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Be(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}n(439);i.a.render(r.a.createElement((function(){return r.a.createElement(s.a,{hashType:"noslash"},r.a.createElement(V,null),r.a.createElement(c.a,{exact:!0,path:"/ImportExport",component:ee}),r.a.createElement(c.a,{exact:!0,path:"/TestRecipeForm",component:B}),r.a.createElement(c.a,{exact:!0,path:"/Reports",component:ie}),r.a.createElement(c.a,{exact:!0,path:"/Planner",component:fe}),r.a.createElement(c.a,{exact:!0,path:"/Shopper",component:Te}),r.a.createElement(c.a,{exact:!0,path:"/Inventory",component:Pe}),r.a.createElement(c.a,{exact:!0,path:"/Online",component:_e}),r.a.createElement(c.a,{exact:!0,path:"/About",component:Ae}),r.a.createElement(c.a,{exact:!0,path:"/",component:U}))}),null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Ue?(!function(e,t){fetch(e).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Be(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Be(t,e)}))}}()}},[[226,1,2]]]);
//# sourceMappingURL=main.b4d3d26c.chunk.js.map